{
    "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
    "id": "f7d56ba6-35a6-453d-8192-8b602bf234bd",
    "name": "notation",
    "friendlyName": "Notation",
    "description": "Azure Pipepine Task for setting up Notation CLI, sign and verify with Notation",
    "helpMarkDown": "",
    "category": "Utility",
    "author": "Notation Developers",
    "version": {
        "Major": 0,
        "Minor": 2,
        "Patch": 76
    },
    "groups": [
        {
            "name": "commandConfig",
            "displayName": "Command Configuration",
            "isExpanded": true
        },
        {
            "name": "pluginConfig",
            "displayName": "Plugin Configuration",
            "isExpanded": true,
            "visibleRule": "command = sign"
        },
        {
            "name": "advancedConfig",
            "displayName": "Advanced Configuration",
            "isExpanded": false,
            "visibleRule": "command = sign || command = verify"
        }
    ],
    "instanceNameFormat": "Install Notation $(notationVersion)",
    "inputs": [
        {
            "name": "command",
            "type": "pickList",
            "label": "Command to run",
            "defaultValue": "install",
            "helpMarkDown": "example: install",
            "required": true,
            "options": {
                "install": "Install",
                "sign": "Sign",
                "verify": "Verify"
            }
        },
        {
            "name": "isCustomVersion",
            "type": "boolean",
            "label": "Custom Version",
            "defaultValue": false,
            "required": false,
            "helpMarkDown": "If checked, you can provide a custom version for the task",
            "visibleRule": "command = install",
            "groupName": "commandConfig"
        },
        {
            "name": "version",
            "type": "string",
            "label": "Version",
            "defaultValue": "1.0.0",
            "required": true,
            "helpMarkDown": "The version of Notation to install. Example: 1.0.0, 1, 1.0, 1.0.0",
            "visibleRule": "command = install && isCustomVersion = false",
            "groupName": "commandConfig"
        },
        {
            "name": "url",
            "type": "string",
            "label": "Download URL",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "example: https://github.com/notaryproject/notation/releases/download/v1.0.0/notation_1.0.0_linux_amd64.tar.gz",
            "groupName": "commandConfig",
            "visibleRule": "command = install && isCustomVersion = true"
        },
        {
            "name": "checksum",
            "type": "string",
            "label": "Checksum",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "The SHA-256 checksum of the downloaded file",
            "groupName": "commandConfig",
            "visibleRule": "command = install && isCustomVersion = true"
        },
        {
            "name": "artifactRefs",
            "type": "string",
            "label": "Artifact references",
            "defaultValue": "",
            "required": false,
            "visibleRule": "command = verify || command = sign",
            "helpMarkDown": "Container artifact references for signing. If it was not specified, use the artifact reference from previous Docker push task. Example: <registry name>/<repository name>@<digest> If multiple, separate by comma.",
            "groupName": "commandConfig"
        },
        {
            "name": "signatureFormat",
            "type": "pickList",
            "label": "Signature Format",
            "defaultValue": "cose",
            "required": false,
            "options": {
                "cose": "cose",
                "jws": "jws"
            },
            "visibleRule": "command = sign",
            "helpMarkDown": "Signature envelope format, options: \"jws\", \"cose\" (default \"jws\")",
            "groupName": "advancedConfig"
        },
        {
            "name": "allowReferrersAPI",
            "type": "boolean",
            "label": "[Experimental] Allow Referrers API",
            "defaultValue": false,
            "required": false,
            "visibleRule": "command = sign || command = verify",
            "helpMarkDown": "Use the Referrers API to sign signatures, if not supported (returns 404), fallback to the Referrers tag schema",
            "groupName": "advancedConfig"
        },
        {
            "name": "plugin",
            "type": "pickList",
            "label": "Plugin",
            "defaultValue": "azureKeyVault",
            "required": true,
            "options": {
                "azureKeyVault": "Azure Key Vault Plugin"
            },
            "groupName": "pluginConfig"
        },
        {
            "name": "azurekvServiceConection",
            "type": "connectedService:AzureRM",
            "label": "Azure Key Vault service connection",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Select the Azure subscription for the key vault if prefer to use service connection for authentication.",
            "visibleRule": "plugin = azureKeyVault",
            "groupName": "pluginConfig"
        },
        {
            "name": "keyid",
            "type": "string",
            "label": "Key ID",
            "required": true,
            "defaultValue": "",
            "helpMarkDown": "The Key ID is the key or certificate identifier for Azure Key Vault.",
            "visibleRule": "plugin = azureKeyVault",
            "groupName": "pluginConfig"
        },
        {
            "name": "caCertBundle",
            "type": "string",
            "label": "Certificate Bundle File Path",
            "required": false,
            "defaultValue": "",
            "visibleRule": "plugin = azureKeyVault",
            "groupName": "pluginConfig"
        },
        {
            "name": "selfSigned",
            "type": "boolean",
            "label": "Self-signed Certificate",
            "required": false,
            "defaultValue": false,
            "visibleRule": "plugin = azureKeyVault",
            "groupName": "pluginConfig"
        },
        {
            "name": "trustPolicy",
            "type": "string",
            "label": "Trust Policy File Path",
            "required": true,
            "defaultValue": "",
            "visibleRule": "command = verify",
            "helpMarkDown": "The path to the [trust policy](https://github.com/notaryproject/specifications/blob/v1.0.0/specs/trust-store-trust-policy.md#trust-policy) file relative to the repository. Example: ./path/to/trust-policy.json",
            "groupName": "commandConfig"
        },
        {
            "name": "trustStore",
            "type": "string",
            "label": "Trust Store Folder Path",
            "required": true,
            "defaultValue": "",
            "visibleRule": "command = verify",
            "helpMarkDown": "The path to the directory containing the [trust store](https://github.com/notaryproject/specifications/blob/v1.0.0/specs/trust-store-trust-policy.md#trust-store) relative to the repository. Example: ./path/to/truststore/",
            "groupName": "commandConfig"
        }
    ],
    "execution": {
        "Node": {
            "target": "src/index.js"
        }
    }
}